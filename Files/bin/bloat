#!/bin/ash
#
# Add a bunch of useful packages that will "bloat" the image
#
# Break this down into three different levels to give options

# Initialize some lists of packages

WHO=`whoami`

# execute again as root
if [ "$WHO" != "root" ]; then
   echo "Executing as root"
   sudo /usr/local/bin/bloat $1
   exit 0
fi

# Read vars
. /usr/local/etc/AOK_VARS

# This whole thing needs to be redone.

little=$BLOAT1_APKS
medium=$BLOAT2_APKS
lotsa=$BLOAT3_APKS
aok=$BLOATAOK_APKS
docs=$BLOATDOCS_APKS

function usage() {
  echo
  echo "Install additional software, numbered options are inclusive of earlier levels"
  echo
  echo "bloat <option>"
  echo
  echo "Where available options are as follows:"
  echo "1 = little bloat, 2 = medium bloat, 3 = lotsa bloat"
  echo "docs   = The docs for packages that come standard on AOK"
  echo "aok    = Stuff that only runs on ish-aok or possibly the linux kernel ish"
  echo 
  echo "1 = $little"
  echo "2 = $little $medium"
  echo "3 = $little $medium $lotsa"
  echo
  echo "docs = $docs"
  echo
  echo "aok = $aok"
}

if [[ -z $1 ]]; then 
  usage
  exit 1
fi

# Start options for special cases

if [[ "$1" = "aok" ]]; then 
  apk add $aok
  exit 0
elif [[ "$1" = "docs" ]]; then 
  apk add $docs
  exit 0
fi

# Normal Options
if [[ "$1" = "1" ]]; then
  apk add $little
elif [[ "$1" = "2" ]]; then
  apk add $little $medium
elif [[ "$1" = "3" ]]; then
  apk add $little $medium $lotsa
else
  usage
fi

exit 0
